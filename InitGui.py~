# ***************************************************************************
# *                                                                         *
# *   Copyright: See License.md file                                        *
# *                                                                         *
# *   Authors: Yash Girish Shah, Grigorios Panagakos                        *
# *                                                                         *
# ***************************************************************************



class packedColGenWorkbench (Workbench):

    MenuText = "Packed Columns"
    ToolTip = "A workbench for generating packed columns with structured packing"
    
    def getWorkbenchFolder(self):

        import os.path
        from os import path
        
        recommended_folders = (
        "Mod/packedColumnGen" ,
        "Mod/FreeCAD-packedColumnGen" 
        )
        
        basedir = str(FreeCAD.getUserAppDataDir())
        folder = ""
        
        for tryfolder in recommended_folders:
                if path.exists(basedir + tryfolder):
                        folder = basedir + tryfolder
                        return folder
        
                        
        return ""
    

    def __init__(self):
        
        self.__class__.Icon = self.getWorkbenchFolder() + "/Resources/Icons/column_icon.svg"

    def Initialize(self):
        """This function is executed when FreeCAD starts"""
        import FreeCAD
        import columnGen # import here all the needed files that create your FreeCAD commands
        self.list = ["PackedColumn","PackedColumn2D","Generate"]
        self.appendToolbar("ColumnGenerator",self.list) # creates a new toolbar with your commands
        self.appendMenu("ColumnGenerator",self.list) # creates a new menu
        #self.appendMenu(["An existing Menu","My submenu"],self.list) # appends a submenu to an existing menu

    def Activated(self):
        """This function is executed when the workbench is activated"""
        return

    def Deactivated(self):
        """This function is executed when the workbench is deactivated"""
        return

    def ContextMenu(self, recipient):
        """This is executed whenever the user right-clicks on screen"""
        # "recipient" will be either "view" or "tree"
        self.appendContextMenu("ColumnGenerator",self.list) # add commands to the context menu

    def GetClassName(self): 
        # this function is mandatory if this is a full python workbench
        return "Gui::PythonWorkbench"
       
Gui.addWorkbench(packedColGenWorkbench())
